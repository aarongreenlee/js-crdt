!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function merge(a,b){return a.merge(b)}function equal(a,b){return a.equal(b)}function compare(a,b){return a.compare(b)}function concat(a,b){return a.concat(b)}function applyOperation(operation,data){return operation.apply(data)}function axioms(assert,a,b,c){assert(equal(merge(a,b),merge(b,a)),"is not commutative"),assert(equal(merge(a,merge(b,c)),merge(merge(a,b),c)),"is not associative"),assert(equal(merge(a,a),a),"is not idempotent")}exports.merge=merge,exports.equal=equal,exports.compare=compare,exports.concat=concat,exports.applyOperation=applyOperation,exports.axioms=axioms},{}],2:[function(require,module,exports){"use strict";var Increment=function(){function Increment(value){this.value=value}return Increment.prototype.merge=function(b){return new Increment(Math.max(this.value,b.value))},Increment.prototype.equal=function(b){return this.value===b.value},Increment.prototype.increment=function(){return new Increment(this.value+1)},Increment}();exports.Increment=Increment},{}],3:[function(require,module,exports){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}__export(require("./functions")),__export(require("./increment")),__export(require("./utils")),__export(require("./order")),__export(require("./text"))},{"./functions":1,"./increment":2,"./order":5,"./text":8,"./utils":10}],4:[function(require,module,exports){"use strict";var utils_1=require("../utils"),Discrete=function(){function Discrete(id,vector){vector=utils_1.clone(vector),vector[id]=vector[id]||0,this.id=id,this.vector=vector}return Discrete.prototype.next=function(){var vector=utils_1.clone(this.vector);return++vector[this.id],new Discrete(this.id,vector)},Discrete.prototype.merge=function(b){var _this=this,vector=utils_1.union(Object.keys(this.vector),Object.keys(b.vector)).reduce(function(vector,key){return vector[key]=Math.max(_this.vector[key]||0,b.vector[key]||0),vector},{});return new Discrete(this.id,vector)},Discrete.prototype.equal=function(b){return 0===this.compare(b)},Discrete.prototype.compare=function(b){var _this=this,position=utils_1.common(this.vector,b.vector).reduce(function(result,key){return result+(_this.vector[key]-b.vector[key])},0);if(0===position){var tipPosition=this.vector[this.id]-b.vector[b.id];if(0!==tipPosition)return tipPosition;var ha=b.vector.hasOwnProperty(this.id),hb=this.vector.hasOwnProperty(b.id);if(!ha&&!hb)return this.id<b.id?-1:1;if(ha&&!hb)return-1;if(hb&&!ha)return 1}return position},Discrete}();exports.Discrete=Discrete},{"../utils":10}],5:[function(require,module,exports){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}__export(require("./discrete")),__export(require("./timestamp")),__export(require("./discrete")),__export(require("./timestamp"))},{"./discrete":4,"./timestamp":6}],6:[function(require,module,exports){"use strict";var Timestamp=function(){function Timestamp(bucket,time){this.bucket=bucket,this.time=time}return Timestamp.prototype.compare=function(b){return this.bucket===b.bucket?this.time-b.time:this.bucket<b.bucket?-1:1},Timestamp.prototype.merge=function(b){return this},Timestamp.prototype.equal=function(b){return!1},Timestamp}();exports.Timestamp=Timestamp},{}],7:[function(require,module,exports){"use strict";var utils_1=require("../utils"),functions_1=require("../functions"),Delete=function(){function Delete(at,length){this.at=at,this.length=length}return Delete.prototype.apply=function(data){return data=utils_1.ensureArrayLength(data,this.at),functions_1.concat(data.slice(0,this.at),data.slice(this.at+this.length))},Delete}();exports.Delete=Delete},{"../functions":1,"../utils":10}],8:[function(require,module,exports){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}__export(require("./delete")),__export(require("./insert"));var functions_1=require("../functions"),Text=function(){function Text(order,ordersIndex,operationsIndex){this.order=order,this.ordersIndex=ordersIndex||[],this.operationsIndex=operationsIndex||[],this.index=this.ordersIndex.findIndex(function(o){return o.equal(order)}),-1===this.index&&(this.index=this.ordersIndex.push(order)-1),this.operationsIndex[this.index]=this.operationsIndex[this.index]||[]}return Text.prototype.apply=function(operation){this.operationsIndex[this.index].push(operation)},Text.prototype.merge=function(b){var ordersIndexA=this.ordersIndex.slice(0),operationsIndexA=this.operationsIndex.slice(0);return operationsIndexA=b.operationsIndex.reduce(function(operationsIndexA,operationsB,orderIndexB){var orderB=b.ordersIndex[orderIndexB],notFoundInA=-1===ordersIndexA.findIndex(function(orderA){return orderA.equal(orderB)});if(notFoundInA){var index=ordersIndexA.push(orderB)-1;operationsIndexA[index]=operationsB}return operationsIndexA},operationsIndexA),new Text(functions_1.merge(this.order,b.order).next(),ordersIndexA,operationsIndexA)},Text.prototype.equal=function(b){return this.toString()===b.toString()},Text.prototype.reduce=function(fn,accumulator){var _this=this;return this.ordersIndex.slice(0).sort(functions_1.compare).reduce(function(accumulator,order){var orderIndex=_this.ordersIndex.findIndex(function(o){return o.equal(order)});return _this.operationsIndex[orderIndex].reduce(function(accumulator,operation,index){return fn(accumulator,operation,order,index)},accumulator)},accumulator)},Text.prototype.toString=function(){return this.reduce(function(accumulator,operation){return functions_1.applyOperation(operation,accumulator)},[]).join("")},Text}();exports.Text=Text},{"../functions":1,"./delete":7,"./insert":9}],9:[function(require,module,exports){"use strict";var utils_1=require("../utils"),functions_1=require("../functions"),Insert=function(){function Insert(at,value){this.at=at,this.value=String(value)}return Insert.prototype.apply=function(data){return data=utils_1.ensureArrayLength(data,this.at),functions_1.concat(functions_1.concat(data.slice(0,this.at),this.value.split("")),data.slice(this.at))},Insert}();exports.Insert=Insert},{"../functions":1,"../utils":10}],10:[function(require,module,exports){"use strict";function between(value,min,max){return!(value<=min)&&!(value>=max)}function ensureArrayLength(array,len){return array.length<len&&(array.length=len),array}function sortNumbers(a,b){return a-b}function clone(obj){var target={};for(var i in obj)obj.hasOwnProperty(i)&&(target[i]=obj[i]);return target}function keyToMap(r,i){return r[i]=!0,r}function union(a,b){return a=a.reduce(keyToMap,{}),b=b.reduce(keyToMap,a),Object.keys(b)}function common(a,b){return Object.keys(a).reduce(function(r,k){return b.hasOwnProperty(k)&&r.push(k),r},[]).sort()}exports.between=between,exports.ensureArrayLength=ensureArrayLength,exports.sortNumbers=sortNumbers,exports.clone=clone,exports.union=union,exports.common=common},{}]},{},[3]);